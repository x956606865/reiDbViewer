---
id: ops-toolkit
sidebar_label: 运维工具
title: 运维工具
---

运维工具面板汇总常用的只读诊断查询，帮助数据库管理员在不破坏业务的前提下快速定位问题。

![运维工具占位符](/img/placeholders/ops-center.svg)

## 预设查询卡片
- 默认提供长事务、阻塞链、等待锁、连接概览等查询。
- 每个卡片展示指标解释、推荐执行频率与参考处理流程。
- 点击卡片会在右侧面板加载结果表格与 SQL 预览。

## 长事务与锁分析
### 操作步骤
1. 选择“长事务”卡片，必要时调整阈值（默认 5 分钟）。
2. 点击 **Run** 触发执行；结果表格会标出 PID、数据库名、等待事件。
3. 若需要终止，请先阅读卡片中的风险提示，再跳转到“连接管理操作”。

### 故障排查
- 如果查询失败，检查执行账号是否具备对 `pg_stat_activity` 的访问权限。
- 当结果为空时，说明当前没有满足阈值的事务，可调整阈值或稍后再试。

## 连接管理操作
- 支持对指定 PID 发出 `pg_cancel_backend` 与 `pg_terminate_backend`。
- 系统要求填写取消原因，并二次确认后才会发送信号。
- 所有操作将写入审计记录，包含操作者、目标 PID 与时间戳。

## 审计与日志
- 计划中的审计模块会记录执行的预设查询、行数分档与耗时。
- 可将结果导出为 CSV，与团队分享巡检记录。

> 重要：任何潜在影响业务的操作都需遵循公司变更流程，请勿在高峰期盲目终止连接。
