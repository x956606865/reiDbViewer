---
id: saved-sql-guide
sidebar_label: Saved SQL 管理
title: Saved SQL 管理
---

Saved SQL 模块支持保存常用查询、设置模板变量、导入导出配置以及共享动态列展示，是团队协作的核心能力之一。

![Saved SQL 列表占位符](/img/placeholders/saved-sql.svg)

## 列表结构
- 左侧树按“文件夹/查询”分层；使用 `/` 分隔的路径会自动转成分组。
- 支持按标签与创建者筛选；右键菜单可重命名、移动或复制。
- 列表顶部提供“最近更新”视图，方便跟进团队变更。

## 创建模板
### 前提条件
- 已在数据浏览器中验证查询逻辑。
- 查询仅包含 `SELECT/WITH`，不涉及写操作。

### 操作步骤
1. 点击右上角的 **New Template**。
2. 输入名称、说明与默认文件夹。
3. 将查询复制到编辑器，使用 `{{variable}}` 声明需要运行时填写的参数。
4. 配置变量类型（string/number/enum/date）与默认值。
5. 保存并运行 `Preview` 以确认参数化 SQL。

### 结果确认
- 预览面板展示的 SQL 应该全部使用 `$n` 占位符；页面提示“Template saved”。

## 动态列展示
- 针对 JSON/数组等动态字段，可配置派生列并命名展示标题。
- 保存后在数据浏览器执行时会自动展开对应列。
- 若需要回滚至默认列，点击“Reset Columns”即可。

## 导入与导出
- 支持导出为 JSON（遵循 `saved-sql-import-export.ts` 定义的 Schema v1）。
- 导入时会执行冲突检测：可选择覆盖、跳过或创建副本。
- 所有导入操作会记录在审计日志中，便于查阅来源。

## 权限提示
- 当前版本默认所有登录用户可访问 Saved SQL；若需团队隔离，可在 APP_DB 中新增 ACL 表。
- 分享敏感查询时，请再次确认变量默认值不会泄露客户信息。
